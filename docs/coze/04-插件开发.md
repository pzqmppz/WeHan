# 扣子插件开发

## 概述

插件扩展了智能体的能力边界，让智能体可以调用外部 API、处理文件、生成图片等。

## 插件类型

### 1. 官方插件
扣子提供的即用型插件：
- 头条新闻
- 天气查询
- 图片搜索
- 网页读取
- 等 100+ 官方插件

### 2. 自定义插件
开发者自己创建的插件，支持：
- 基于 API 创建
- 使用 IDE 创建
- JSON/YAML 导入
- 代码注册

## 创建自定义插件

### 方式一：基于 API 创建

1. 进入插件中心
2. 点击「创建插件」
3. 选择「基于 API 创建」
4. 配置 API 信息：
   - API 地址
   - 请求方法
   - 请求参数
   - 响应格式

### 方式二：导入 cURL

HTTP 请求节点支持导入 cURL 命令：

```bash
curl --location --request POST 'https://api.example.com/endpoint' \
--header 'Authorization: Bearer YOUR_TOKEN' \
--header 'Content-Type: application/json' \
--data '{ "key": "value" }'
```

## 调用付费插件

```bash
curl --location --request POST 'https://api.coze.cn/v1/plugins/7545873263293***/tools/call' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer pat_3UXDHN82MgQANqK***' \
--data-raw '{
  "tool_name": "getToutiaoNews",
  "arguments": {
    "q": "杭州秋假"
  }
}'
```

## 插件配置项

| 配置项 | 说明 |
|-------|------|
| 插件 ID | 唯一标识 |
| 插件名称 | 显示名称 |
| 描述 | 功能说明 |
| API 地址 | 请求 URL |
| 请求方法 | GET/POST/PUT/DELETE |
| 请求参数 | 输入参数定义 |
| 鉴权方式 | API Key / OAuth / 自定义 |
| 超时时间 | 默认 120s |

## HTTP 请求节点详解

### 鉴权配置

| 类型 | 说明 |
|-----|------|
| Bearer Token | OAuth 2.0 令牌 |
| 自定义 | Key-Value 形式 |
| 无需鉴权 | 公开 API |

### 请求体格式

| 格式 | 说明 |
|-----|------|
| form-data | 表单数据 |
| x-www-form-urlencoded | URL 编码 |
| JSON | JSON 格式 |
| raw text | 纯文本 |

### 异常处理

- **超时设置**：默认 120s，最长 600s
- **重试次数**：默认 3 次，最大 10 次
- **异常忽略**：开启后节点失败不中断工作流

## 常用插件示例

### 1. 链接读取插件

用于获取网页、PDF、抖音视频内容：

```yaml
pluginID: "7379227817307013129"
pluginName: "链接读取"
apiID: "7379227817307029513"
apiName: "LinkReaderPlugin"
```

### 2. 头条新闻插件

获取新闻资讯：

```json
{
  "tool_name": "getToutiaoNews",
  "arguments": {
    "q": "关键词"
  }
}
```

## 插件权限

- **个人空间插件**：仅能被个人调用
- **团队空间插件**：能被任意团队成员调用
- **版本管理**：发布新版本后，使用该插件的智能体自动使用最新版本

## 最佳实践

1. **API 设计**：保持接口简洁，参数明确
2. **错误处理**：返回清晰的错误信息
3. **文档完善**：提供详细的使用说明
4. **版本控制**：合理管理插件版本

## 相关链接

- 插件文档: https://docs.coze.cn/guides/plugin
- HTTP 节点文档: https://docs.coze.cn/guides/http_node
