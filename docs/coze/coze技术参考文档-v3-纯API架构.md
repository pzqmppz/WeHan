# WeHan C ç«¯ Coze æŠ€æœ¯æ¡†æ¶ v3.0

> **æ¶æ„æ›´æ–°**ï¼šé‡‡ç”¨ã€ŒB ç«¯ API å•ä¸€æ•°æ®æºã€æ¶æ„ï¼Œä¸å†ä½¿ç”¨ Coze çŸ¥è¯†åº“

**æ›´æ–°æ—¶é—´**: 2026-02-28 (v3.0 - çº¯ API æ¶æ„)

---

## æ¶æ„å˜æ›´è¯´æ˜

### v2.x â†’ v3.0 ä¸»è¦å˜æ›´

| å˜æ›´é¡¹ | v2.xï¼ˆæ—§æ¶æ„ï¼‰ | v3.0ï¼ˆæ–°æ¶æ„ï¼‰ |
|-------|---------------|---------------|
| **æ•°æ®æº** | Coze çŸ¥è¯†åº“ + B ç«¯ API | **ä»… B ç«¯ API** |
| **æ•°æ®åŒæ­¥** | éœ€è¦å¯¼å‡ºä¸Šä¼ åˆ° Coze | **æ— éœ€åŒæ­¥ï¼Œå®æ—¶æŸ¥è¯¢** |
| **ç»´æŠ¤æˆæœ¬** | ç»´æŠ¤ä¸¤ä»½æ•°æ® | **å•ä¸€æ•°æ®æº** |
| **éƒ¨ç½²ä¾èµ–** | éœ€è¦çŸ¥è¯†åº“ API | **ä»…éœ€æ™ºèƒ½ä½“ API** |
| **ç½‘ç»œä¾èµ–** | Bot ä¾èµ– Coze çŸ¥è¯†åº“ | **Bot ä¾èµ– B ç«¯ API** |

### å˜æ›´åŸå› 

1. **API æµ‹è¯•ç»“æœ**ï¼šCoze çŸ¥è¯†åº“ API å…¨éƒ¨è¿”å› 404ï¼Œå®˜æ–¹æœªæä¾›å¯ç”¨ç«¯ç‚¹
2. **æ¶æ„ç®€åŒ–**ï¼šå•ä¸€æ•°æ®æºæ›´æ˜“ç»´æŠ¤ï¼Œæ•°æ®ä¸€è‡´æ€§æ›´å¥½
3. **å®æ—¶æ€§**ï¼šç›´æ¥æŸ¥è¯¢ B ç«¯è·å–æœ€æ–°æ•°æ®ï¼Œæ— åŒæ­¥å»¶è¿Ÿ

---

## ä¸€ã€æ–°æ¶æ„è®¾è®¡

### 1.1 æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WeHan æ±‚èŒåŠ©æ‰‹ï¼ˆå• Botï¼‰                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ã€ä¸» Botã€‘WeHan æ±‚èŒåŠ©æ‰‹                                  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ æ„å›¾è¯†åˆ«ï¼šé¢è¯• vs å¿ƒç†ç–å¯¼ vs å²—ä½æŸ¥è¯¢ vs æ”¿ç­–å’¨è¯¢    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ è·¯ç”±è§„åˆ™ï¼š                                            â”‚  â”‚
â”‚  â”‚  â”‚   "é¢è¯•/åˆ·é¢˜/ç®€å†" â†’ è§¦å‘é¢è¯•å·¥ä½œæµ                    â”‚  â”‚
â”‚  â”‚  â”‚   "æŸ¥å²—ä½/æ‰¾å·¥ä½œ" â†’ HTTP æŸ¥è¯¢ B ç«¯å²—ä½ API             â”‚  â”‚
â”‚  â”‚  â”‚   "æ”¿ç­–/è¡¥è´´" â†’ HTTP æŸ¥è¯¢ B ç«¯æ”¿ç­– API                 â”‚  â”‚
â”‚  â”‚  â”‚   "ç„¦è™‘/å‹åŠ›å¤§" â†’ è§¦å‘å¿ƒç†ç–å¯¼                         â”‚  â”‚
â”‚  â”‚  â””â”€â”€ æŠ€èƒ½åˆ†å‘                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â–¼                  â–¼                  â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ é¢è¯•å·¥ä½œæµ   â”‚   â”‚ å²—ä½æŸ¥è¯¢    â”‚   â”‚ æ”¿ç­–æŸ¥è¯¢    â”‚          â”‚
â”‚  â”‚             â”‚   â”‚ (HTTP)      â”‚   â”‚ (HTTP)      â”‚          â”‚
â”‚  â”‚ HTTPèŠ‚ç‚¹ â†’  â”‚   â”‚             â”‚   â”‚             â”‚          â”‚
â”‚  â”‚ Bç«¯API      â”‚   â”‚ Bç«¯API      â”‚   â”‚ Bç«¯API      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     B ç«¯æ•°æ®åº“ (PostgreSQL)                  â”‚
â”‚  â”œâ”€â”€ jobs (å²—ä½)        â”œâ”€â”€ policies (æ”¿ç­–)                  â”‚
â”‚  â”œâ”€â”€ resumes (ç®€å†)    â”œâ”€â”€ applications (æŠ•é€’)               â”‚
â”‚  â””â”€â”€ interviews (é¢è¯•) â””â”€â”€ conversations (ä¼šè¯)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ•°æ®æµè¯´æ˜

| åœºæ™¯ | æ•°æ®æµ |
|-----|-------|
| **ç”¨æˆ·æŸ¥è¯¢å²—ä½** | Bot â†’ HTTP èŠ‚ç‚¹ â†’ B ç«¯ `/api/open/jobs` â†’ è¿”å›å²—ä½åˆ—è¡¨ |
| **å¼€å§‹é¢è¯•** | Bot â†’ è§¦å‘å·¥ä½œæµ â†’ HTTP èŠ‚ç‚¹è·å– JD â†’ ç”Ÿæˆé¢˜ç›® â†’ è¯­éŸ³å¯¹è¯ â†’ ä¿å­˜æŠ¥å‘Šåˆ° B ç«¯ |
| **æŸ¥è¯¢æ”¿ç­–** | Bot â†’ HTTP èŠ‚ç‚¹ â†’ B ç«¯ `/api/open/policies` â†’ è¿”å›æ”¿ç­–åˆ—è¡¨ |
| **å¿ƒç†ç–å¯¼** | Bot ç›´æ¥å¯¹è¯ï¼ˆä¸æŸ¥è¯¢å¤–éƒ¨ APIï¼‰ |

---

## äºŒã€é¡¹ç›®ç›®å½•ç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰

```
wehan_coze/
â”œâ”€â”€ config/                      # é…ç½®å±‚
â”‚   â”œâ”€â”€ settings.py              # ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ schema/                  # JSON Schema æ ¡éªŒ
â”‚   â”‚   â”œâ”€â”€ bot_schema.json
â”‚   â”‚   â””â”€â”€ workflow_schema.json
â”‚   â””â”€â”€ local/                   # æœ¬åœ°é…ç½®æ–‡ä»¶
â”‚       â”œâ”€â”€ wehan_bot.json       # æ™ºèƒ½ä½“é…ç½®
â”‚       â””â”€â”€ interview_workflow.json  # é¢è¯•å·¥ä½œæµé…ç½®
â”‚
â”œâ”€â”€ coze/                        # Coze å¹³å°å°è£…
â”‚   â”œâ”€â”€ admin.py                 # ç®¡ç†APIï¼ˆä»…æ™ºèƒ½ä½“ï¼‰
â”‚   â”œâ”€â”€ agent.py                 # æ™ºèƒ½ä½“å¯¹è¯
â”‚   â””â”€â”€ workflow.py              # å·¥ä½œæµæ‰§è¡Œ
â”‚
â”œâ”€â”€ api/                         # B ç«¯ API å¯¹æ¥
â”‚   â”œâ”€â”€ jobs.py                  # å²—ä½æŸ¥è¯¢
â”‚   â”œâ”€â”€ policies.py              # æ”¿ç­–æŸ¥è¯¢
â”‚   â”œâ”€â”€ interviews.py            # é¢è¯•æŠ¥å‘Š
â”‚   â”œâ”€â”€ resumes.py               # ç®€å†ç®¡ç†
â”‚   â””â”€â”€ conversations.py         # ä¼šè¯ç®¡ç†
â”‚
â”œâ”€â”€ core/                        # é€šç”¨èƒ½åŠ›
â”‚   â”œâ”€â”€ exceptions.py
â”‚   â”œâ”€â”€ retry.py
â”‚   â””â”€â”€ logger.py
â”‚
â””â”€â”€ main/
    â”œâ”€â”€ main_deploy.py          # éƒ¨ç½²æµç¨‹ï¼ˆä»…æ™ºèƒ½ä½“ï¼‰
    â””â”€â”€ main_interview.py        # é¢è¯•ä¸»æµç¨‹
```

**ç§»é™¤çš„ç»„ä»¶**ï¼š
- âŒ `config/local/knowledge_docs/` - ä¸å†éœ€è¦çŸ¥è¯†åº“æ–‡æ¡£
- âŒ `coze/knowledge.py` - ä¸å†éœ€è¦çŸ¥è¯†åº“ç®¡ç†
- âŒ `coze/file.py` - ä¸å†éœ€è¦æ–‡ä»¶ä¸Šä¼ 

---

## ä¸‰ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶

### 3.1 config/settings.py

```python
"""
C ç«¯é…ç½®æ–‡ä»¶ - v3.0 çº¯ API æ¶æ„
"""
import os
from dotenv import load_dotenv

PROJECT_ROOT = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
load_dotenv(os.path.join(PROJECT_ROOT, '.env'))

# ===================== Coze åŸºç¡€é…ç½® =====================
COZE_PAT = os.getenv("COZE_PAT")
SPACE_ID = os.getenv("SPACE_ID")
BOT_ID = os.getenv("BOT_ID", "")

# å®æ—¶è¯­éŸ³é…ç½®
CONNECTOR_ID = os.getenv("CONNECTOR_ID", "1024")
VOICE_ID = os.getenv("VOICE_ID", "7426720361733046281")

# ===================== Bç«¯ API é…ç½®ï¼ˆæ ¸å¿ƒæ•°æ®æºï¼‰====================
B_API_BASE_URL = os.getenv("B_API_BASE_URL", "http://localhost:3000/api/open")
B_API_KEY = os.getenv("OPEN_API_KEY")
B_API_TIMEOUT = int(os.getenv("B_API_TIMEOUT", "30"))

# ===================== é€šç”¨é…ç½® =====================
COZE_API_TIMEOUT = 30
COZE_WORKFLOW_TIMEOUT = 120
LOG_LEVEL = "INFO"
```

### 3.2 config/local/wehan_bot.json

```json
{
  "name": "WeHan æ±‚èŒåŠ©æ‰‹",
  "description": "æ­¦æ±‰é«˜æ ¡æ¯•ä¸šç”Ÿä¸€ç«™å¼æ±‚èŒåŠ©æ‰‹",
  "instructions": "# è§’è‰²ï¼šWeHan æ±‚èŒ&å¿ƒç†é™ªä¼´åŠ©æ‰‹\n\nä½ æ˜¯ä¸ºæ­¦æ±‰é«˜æ ¡æ¯•ä¸šç”ŸæœåŠ¡çš„ä¸€ç«™å¼æ±‚èŒåŠ©æ‰‹ã€‚\n\n## æ ¸å¿ƒèƒ½åŠ›\n\n### æŸ¥è¯¢å²—ä½\n- å½“ç”¨æˆ·é—®\"æœ‰å“ªäº›å²—ä½\"\"\"æ‰¾å·¥ç¨‹å¸ˆå·¥ä½œ\"\"æ—¶ï¼Œè°ƒç”¨ get_jobs å‡½æ•°\n- æ”¯æŒæŒ‰è¡Œä¸šã€è–ªèµ„ã€åœ°åŒºç­›é€‰\n\n### æŸ¥è¯¢æ”¿ç­–\n- å½“ç”¨æˆ·é—®\"ç•™æ±‰æ”¿ç­–\"\"\"äººæ‰è¡¥è´´\"\"æ—¶ï¼Œè°ƒç”¨ get_policies å‡½æ•°\n- è¿”å›æ­¦æ±‰æœ€æ–°äººæ‰æ”¿ç­–\n\n### AI é¢è¯•\n- å½“ç”¨æˆ·è¯´\"å¼€å§‹é¢è¯•\"\"\"æ¨¡æ‹Ÿé¢è¯•\"\"æ—¶ï¼Œè°ƒç”¨ start_interview å‡½æ•°\n- åŸºäºå²—ä½ JD ç”Ÿæˆé¢è¯•é¢˜ï¼Œè¿›è¡Œè¯­éŸ³å¯¹è¯\n\n### å¿ƒç†ç–å¯¼\n- å½“ç”¨æˆ·è¡¨è¾¾ç„¦è™‘ã€å‹åŠ›æ—¶ï¼Œæä¾›å¿ƒç†æ”¯æŒå’Œå»ºè®®\n\n## è¡Œä¸ºè§„åˆ™\n1. ä¼˜å…ˆç†è§£ç”¨æˆ·æ„å›¾ï¼Œé€‰æ‹©åˆé€‚çš„å·¥å…·\n2. ä¸ç¼–é€ å²—ä½å’Œæ”¿ç­–ä¿¡æ¯ï¼Œé€šè¿‡ API è·å–çœŸå®æ•°æ®\n3. é¢è¯•æµç¨‹ä¸­ä¿æŒä¸“ä¸šï¼Œå®Œæˆåæä¾›è¯¦ç»†åé¦ˆ",
  "welcome_message": "ä½ å¥½ï¼æˆ‘æ˜¯ WeHan æ±‚èŒåŠ©æ‰‹ ğŸ‘‹\n\næˆ‘å¯ä»¥å¸®ä½ ï¼š\n- ğŸ” æŸ¥è¯¢æ­¦æ±‰åœ°åŒºå²—ä½\n- ğŸ“œ æŸ¥è¯¢ç•™æ±‰äººæ‰æ”¿ç­–\n- ğŸ¤ AI æ¨¡æ‹Ÿé¢è¯•è®­ç»ƒ\n- ğŸ’š æ±‚èŒå¿ƒç†æ”¯æŒ\n\nè¯·é—®ä½ æƒ³åšä»€ä¹ˆï¼Ÿ",
  "visibility": "private"
}
```

### 3.3 config/local/interview_workflow.json

```json
{
  "version": "1.0",
  "name": "WeHan é¢è¯•æ¨¡æ‹Ÿå·¥ä½œæµ",
  "description": "é€šè¿‡ B ç«¯ API è·å– JDï¼Œç”Ÿæˆé¢è¯•é¢˜ï¼Œè¯­éŸ³å¯¹è¯ï¼Œä¿å­˜æŠ¥å‘Šåˆ° B ç«¯",
  "nodes": [
    {
      "id": "start",
      "type": "start",
      "config": {
        "parameters": [
          { "name": "job_id", "type": "string", "required": true },
          { "name": "user_id", "type": "string", "required": true }
        ]
      }
    },
    {
      "id": "get_job_detail",
      "type": "http",
      "config": {
        "url": "${B_API_BASE_URL}/jobs/${job_id}",
        "method": "GET",
        "headers": {
          "X-API-Key": "${B_API_KEY}",
          "Content-Type": "application/json"
        }
      }
    },
    {
      "id": "generate_questions",
      "type": "llm",
      "config": {
        "prompt": "ä½ æ˜¯ä¸“ä¸šçš„é¢è¯•å®˜ã€‚æ ¹æ®ä»¥ä¸‹å²—ä½ JDï¼Œç”Ÿæˆ 10-15 é“é¢è¯•é¢˜ï¼š\n\nå²—ä½ä¿¡æ¯ï¼š\n${get_job_detail.body}\n\nè¦æ±‚ï¼š\n1. é¢˜ç›®éš¾åº¦é€‚ä¸­\n2. æ¶µç›–ä¸“ä¸šçŸ¥è¯†ã€é¡¹ç›®ç»éªŒã€è½¯æŠ€èƒ½\n3. è¾“å‡º JSON æ ¼å¼\n\nè¾“å‡ºæ ¼å¼ï¼š\n{\"questions\": [{\"id\": 1, \"question\": \"é¢˜ç›®å†…å®¹\", \"category\": \"ä¸“ä¸šçŸ¥è¯†\"}]}"
      }
    },
    {
      "id": "voice_interview",
      "type": "interaction",
      "config": {
        "connector_id": "${CONNECTOR_ID}",
        "voice_id": "${VOICE_ID}",
        "turn_detection": {
          "type": "semantic_vad",
          "semantic_vad_config": {
            "silence_threshold_ms": 300
          }
        }
      }
    },
    {
      "id": "save_report",
      "type": "http",
      "config": {
        "url": "${B_API_BASE_URL}/interviews",
        "method": "POST",
        "headers": {
          "X-API-Key": "${B_API_KEY}",
          "Content-Type": "application/json"
        },
        "body": {
          "userId": "${user_id}",
          "jobId": "${job_id}",
          "totalScore": "${generate_report.body.totalScore}",
          "dimensions": "${generate_report.body.dimensions}",
          "highlights": "${generate_report.body.highlights}",
          "improvements": "${generate_report.body.improvements}",
          "suggestions": "${generate_report.body.suggestions}"
        }
      }
    },
    {
      "id": "end",
      "type": "end",
      "config": {
        "outputs": [
          { "name": "report", "value": "${generate_report.body}" }
        ]
      }
    }
  ],
  "edges": [
    { "source": "start", "target": "get_job_detail" },
    { "source": "get_job_detail", "target": "generate_questions" },
    { "source": "generate_questions", "target": "voice_interview" },
    { "source": "voice_interview", "target": "save_report" },
    { "source": "save_report", "target": "end" }
  ]
}
```

---

## å››ã€B ç«¯ API å°è£…

### 4.1 api/jobs.py

```python
"""
B ç«¯å²—ä½ API å¯¹æ¥
"""
import requests
from config.settings import B_API_BASE_URL, B_API_KEY, B_API_TIMEOUT

def get_jobs(industry: str = None, min_salary: int = None):
    """è·å–å²—ä½åˆ—è¡¨"""
    url = f"{B_API_BASE_URL}/jobs"
    headers = {"X-API-Key": B_API_KEY}
    params = {}
    if industry:
        params["industry"] = industry
    if min_salary:
        params["minSalary"] = min_salary

    response = requests.get(url, headers=headers, params=params, timeout=B_API_TIMEOUT)
    response.raise_for_status()
    return response.json()["data"]

def get_job_detail(job_id: str):
    """è·å–å²—ä½è¯¦æƒ…"""
    url = f"{B_API_BASE_URL}/jobs/{job_id}"
    headers = {"X-API-Key": B_API_KEY}

    response = requests.get(url, headers=headers, timeout=B_API_TIMEOUT)
    response.raise_for_status()
    return response.json()["data"]
```

### 4.2 api/policies.py

```python
"""
B ç«¯æ”¿ç­– API å¯¹æ¥
"""
import requests
from config.settings import B_API_BASE_URL, B_API_KEY, B_API_TIMEOUT

def get_policies(category: str = None):
    """è·å–æ”¿ç­–åˆ—è¡¨"""
    url = f"{B_API_BASE_URL}/policies"
    headers = {"X-API-Key": B_API_KEY}

    response = requests.get(url, headers=headers, timeout=B_API_TIMEOUT)
    response.raise_for_status()
    return response.json()["data"]
```

---

## äº”ã€éƒ¨ç½²æµç¨‹ï¼ˆç®€åŒ–ç‰ˆï¼‰

### 5.1 éƒ¨ç½²æ­¥éª¤

ç”±äºä¸å†ä½¿ç”¨çŸ¥è¯†åº“å’Œå·¥ä½œæµ APIï¼ˆå‡ä¸å¯ç”¨ï¼‰ï¼Œéƒ¨ç½²æµç¨‹å¤§å¹…ç®€åŒ–ï¼š

```python
"""
ç®€åŒ–ç‰ˆéƒ¨ç½²æµç¨‹ - ä»…åˆ›å»ºæ™ºèƒ½ä½“
"""
from coze.admin import CozeAdminAPI

def deploy():
    admin = CozeAdminAPI()

    # æ­¥éª¤ 1ï¼šåˆ›å»ºæ™ºèƒ½ä½“
    bot_id = admin.create_bot("config/local/wehan_bot.json")
    print(f"æ™ºèƒ½ä½“åˆ›å»ºæˆåŠŸï¼š{bot_id}")

    # æ­¥éª¤ 2ï¼šæ›´æ–°æ™ºèƒ½ä½“ï¼ˆå¦‚éœ€è¦ï¼‰
    # admin.update_bot(bot_id, {...})

    # æ­¥éª¤ 3ï¼šå‘å¸ƒæ™ºèƒ½ä½“
    # admin.publish_bot(bot_id)

    return bot_id

if __name__ == "__main__":
    bot_id = deploy()
    print(f"éƒ¨ç½²å®Œæˆï¼Bot ID: {bot_id}")
```

### 5.2 .env é…ç½®

```bash
# Coze å¹³å°é…ç½®
COZE_PAT=pat_ä½ çš„PAT
SPACE_ID=ä½ çš„ç©ºé—´ID
BOT_ID=

# B ç«¯ API é…ç½®ï¼ˆæ ¸å¿ƒæ•°æ®æºï¼‰
B_API_BASE_URL=http://localhost:3000/api/open
OPEN_API_KEY=wehan_dev_test_2026
B_API_TIMEOUT=30

# å®æ—¶è¯­éŸ³é…ç½®
CONNECTOR_ID=1024
VOICE_ID=7426720361733046281
```

---

## å…­ã€API æµ‹è¯•ç»“æœï¼ˆ2026-02-28ï¼‰

### å¯ç”¨çš„ API ç«¯ç‚¹

| åŠŸèƒ½ | ç«¯ç‚¹ | çŠ¶æ€ |
|-----|------|-----|
| åˆ›å»ºæ™ºèƒ½ä½“ | `POST /v1/bot/create` | âœ… å¯ç”¨ |
| æ›´æ–°æ™ºèƒ½ä½“ | `POST /v1/bot/update` | âœ… å¯ç”¨ |
| è·å–æ™ºèƒ½ä½“åˆ—è¡¨ | `GET /v1/bots?workspace_id={id}` | âœ… å¯ç”¨ |

### ä¸å¯ç”¨çš„ API ç«¯ç‚¹

| åŠŸèƒ½ | ç«¯ç‚¹ | çŠ¶æ€ |
|-----|------|-----|
| åˆ›å»ºå·¥ä½œæµ | `POST /v1/workflow` | âŒ 404 |
| åˆ›å»ºçŸ¥è¯†åº“ | `POST /v1/knowledge_base` | âŒ 404 |
| ä¸Šä¼ æ–‡æ¡£ | `POST /v1/knowledge_base/{id}/document` | âŒ 404 |

**ç»“è®º**ï¼šç”±äºå·¥ä½œæµå’ŒçŸ¥è¯†åº“ API å‡ä¸å¯ç”¨ï¼Œé‡‡ç”¨ **çº¯ HTTP èŠ‚ç‚¹è°ƒç”¨ B ç«¯ API** çš„æ¶æ„ã€‚

---

## ä¸ƒã€ä¼˜åŠ¿å¯¹æ¯”

| å¯¹æ¯”é¡¹ | çŸ¥è¯†åº“æ¶æ„ | çº¯ API æ¶æ„ï¼ˆv3.0ï¼‰ |
|-------|-----------|---------------------|
| **æ•°æ®æº** | Coze çŸ¥è¯†åº“ + B ç«¯ | ä»… B ç«¯ |
| **æ•°æ®ä¸€è‡´æ€§** | éœ€è¦åŒæ­¥ | å®æ—¶ä¸€è‡´ âœ… |
| **ç»´æŠ¤æˆæœ¬** | ä¸¤ä»½æ•°æ® | å•ä¸€æ•°æ®æº âœ… |
| **API ä¾èµ–** | éœ€è¦çŸ¥è¯†åº“ APIï¼ˆä¸å¯ç”¨ï¼‰ | ä»…éœ€æ™ºèƒ½ä½“ API âœ… |
| **éƒ¨ç½²å¤æ‚åº¦** | éœ€è¦ä¸Šä¼ æ–‡æ¡£ | é…ç½®å³ç”¨ âœ… |
| **ç½‘ç»œå»¶è¿Ÿ** | ä½ï¼ˆCoze å†…éƒ¨ï¼‰ | å¯æ¥å—ï¼ˆHTTP è°ƒç”¨ï¼‰ |

---

## å…«ã€å¼€å‘è®¡åˆ’ï¼ˆæ›´æ–°ï¼‰

### é˜¶æ®µ 1ï¼šåŸºç¡€é…ç½®ï¼ˆå·²å®Œæˆï¼‰
- âœ… é…ç½® PAT å’Œ SPACE_ID
- âœ… éªŒè¯ B ç«¯ API å¯ç”¨æ€§
- âœ… åˆ›å»ºæ™ºèƒ½ä½“é…ç½®æ–‡ä»¶

### é˜¶æ®µ 2ï¼šæ™ºèƒ½ä½“éƒ¨ç½²ï¼ˆè¿›è¡Œä¸­ï¼‰
- â³ é€šè¿‡ API åˆ›å»ºæ™ºèƒ½ä½“
- â³ é…ç½®å·¥å…·å‡½æ•°ï¼ˆget_jobs, get_policiesï¼‰
- â³ æµ‹è¯•å¯¹è¯åŠŸèƒ½

### é˜¶æ®µ 3ï¼šåŠŸèƒ½æµ‹è¯•ï¼ˆå¾…å¼€å§‹ï¼‰
- â³ æµ‹è¯•å²—ä½æŸ¥è¯¢åŠŸèƒ½
- â³ æµ‹è¯•æ”¿ç­–æŸ¥è¯¢åŠŸèƒ½
- â³ æµ‹è¯•å¿ƒç†ç–å¯¼åŠŸèƒ½

### é˜¶æ®µ 4ï¼šé¢è¯•åŠŸèƒ½ï¼ˆå¾…å¼€å§‹ï¼‰
- â³ åœ¨ Coze ç½‘é¡µå¹³å°æ‰‹åŠ¨é…ç½®å·¥ä½œæµ
- â³ æµ‹è¯•å®Œæ•´é¢è¯•æµç¨‹
- â³ éªŒè¯æŠ¥å‘Šä¿å­˜åˆ° B ç«¯

---

*æ–‡æ¡£ç‰ˆæœ¬: 3.0 | æ›´æ–°æ—¶é—´: 2026-02-28*
*æ¶æ„ç±»å‹: çº¯ B ç«¯ API æ¶æ„*
*æ ¸å¿ƒå˜æ›´: ç§»é™¤çŸ¥è¯†åº“ä¾èµ–ï¼Œä½¿ç”¨ HTTP èŠ‚ç‚¹ç›´æ¥æŸ¥è¯¢ B ç«¯*
